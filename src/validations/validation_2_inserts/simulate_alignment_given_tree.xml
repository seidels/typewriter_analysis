<beast version="2.0"
       namespace="beast.core
                 :beast.core.util
                 :beast.core.parameter
                 :beast.evolution.alignment
                 :beast.evolution.likelihood
                 :beast.evolution.tree
                 :beast.evolution.tree.coalescent
                 :beast.evolution.sitemodel
                 :beast.evolution.substitutionmodel
                 :beast.evolution.operators
                 :beast.math.distributions
                 :feast.simulation
                 :bdmmprime.distribution
                 :bdmmprime.parameterization
                 :bdmmprime.mapping">


  <!-- insert rate and clock rate -->
  <parameter id="insertRates"
	     spec="feast.fileio.RealParameterFromXSV" 
	     name="stateNode"
	     fileName="/Users/seidels/Projects/typewriter_analysis/results/validation_2_inserts/simulation_parameters/simParams_$(seed).csv"
	     sep="," startRow="1" rowCount="2"
	     startCol="1" colCount="1" /> 

    <parameter id="clockRate"
	     spec="feast.fileio.RealParameterFromXSV" 
	     name="stateNode"
	     fileName="/Users/seidels/Projects/typewriter_analysis/results/validation_2_inserts/simulation_parameters/simParams_$(seed).csv"
	     sep="," startRow="3" rowCount="1"
	     startCol="1" colCount="1" /> 

    <origin id="origin" spec="RealParameter" value="25"/> <!-- Length of simulation -->

<stateNode spec='beast.util.TreeParser' id='simulatedTree' IsLabelledNewick='true' adjustTipHeights='false'
               newick='(((((((((275:11.547711142134812,1:11.547711142134812)393:0.6050473888723378,173:12.15275853100715)428:3.1393217097637027,(290:13.60759635517013,(221:12.927329809816786,(240:12.922117426085846,267:12.922117426085846)461:0.005212383730940573)462:0.6802665453533443)496:1.6844838856007218)569:3.881855958358125,((130:15.739842434380465,((144:9.477051773310267,93:9.477051773310267)352:4.630935415274399,297:14.107987188584666)521:1.6318552457957995)584:1.4123469596570946,(((((21:9.068334338018746,(279:8.298158801432052,231:8.298158801432052)338:0.7701755365866934)348:3.4932078221122502,56:12.561542160130996)440:1.399466302296819,(24:9.842627679892123,122:9.842627679892123)358:4.1183807825356915)508:0.08600844637821048,(111:10.924134543541252,166:10.924134543541252)375:3.1228823652647737)516:0.9687466497228243,88:15.01576355852885)556:2.1364258355087102)611:2.021746805091418)624:1.5648668647412194,(((224:8.611326110479801,37:8.611326110479801)343:3.5088512021945206,(216:10.96458343916243,26:10.96458343916243)377:1.1555938735118918)426:3.1415125363601284,(177:14.307967676375334,((196:13.496846170692773,(190:13.223265924176863,124:13.223265924176863)479:0.27358024651591073)494:0.30877655184911745,(((52:11.66202033687075,(59:10.829278153173853,183:10.829278153173853)372:0.8327421836968973)399:1.5399908905696762,((10:5.29372232125467,314:5.29372232125467)320:7.889937357247671,(225:12.609109632569792,(262:11.514791903430869,131:11.514791903430869)391:1.0943177291389237)444:0.5745500459325488)473:0.018351548938085216)476:0.2221362472527897,289:13.424147474693216)492:0.3814752478486749)501:0.5023449538334432)525:0.9537221726591163)565:5.477113214835747)628:0.24258302742720872,((271:13.916225042099983,34:13.916225042099983)505:0.612145787131702,(137:13.737983899788906,49:13.737983899788906)499:0.7903869294427786)540:6.453015262065721)629:0.02714018985805211,(((((((((36:11.450995225283704,(((136:9.514970632028097,72:9.514970632028097)354:0.5643678145246618,310:10.07933844655276)359:1.3376808777255178,90:11.417019324278277)386:0.03397590100542658)389:0.3609812691055332,74:11.811976494389237)411:3.1883195087507623,75:15.000296003139999)555:0.449644697713655,((78:12.208211340164159,(4:8.054809665672224,83:8.054809665672224)337:4.153401674491935)431:2.5926307588770445,((((181:11.308925503654493,237:11.308925503654493)383:1.7510628543395264,(57:12.70746920097574,247:12.70746920097574)448:0.3525191570182784)468:0.14006720885774904,(227:13.113748160357098,(53:12.402049864302622,249:12.402049864302622)438:0.7116982960544753)472:0.0863074064946705)475:0.5126782308993025,203:13.71273379775107)497:1.0881083012901325)549:0.6490986018124509)575:1.2481554235842953,(((118:6.714961122624985,(91:4.695793424284389,65:4.695793424284389)318:2.0191676983405955)326:6.870768655122378,60:13.585729777747362)495:2.753456908929282,((222:10.80372423266772,(0:9.189429960055088,157:9.189429960055088)349:1.6142942726126321)370:2.4161456174434104,(((61:8.891618629710063,217:8.891618629710063)344:3.9213951928691735,(22:10.264439661212526,(193:6.512451382396119,206:6.512451382396119)324:3.751988278816407)363:2.5485741613667106)456:0.29335005545879156,253:13.106363878038028)471:0.11350597207310287)478:3.1193168365655133)596:0.35890943776130513)602:1.1888783546566586,((((50:14.355499477057057,((13:7.9444386005222505,199:7.9444386005222505)335:3.851779290054436,277:11.796217890576687)407:2.5592815864803704)528:0.3066240950190853,(212:14.433956430551136,76:14.433956430551136)534:0.22816714152500595)544:1.5373268421174142,((123:14.828138839261713,139:14.828138839261713)550:0.46119436861042296,94:15.289333207872136)567:0.91011720632142)594:0.7564506339220571,((15:14.787718556388738,((263:13.756142729879775,(273:11.088126395348,228:11.088126395348)381:2.6680163345317744)500:0.7585899334449948,((64:11.706434373762086,264:11.706434373762086)402:2.235300256966923,(252:13.828248656858118,19:13.828248656858118)502:0.11348597387089043)506:0.5729980325957609)539:0.2729858930639679)548:0.6292331173429027,((194:14.543517135122988,((6:11.798932688235498,(11:10.53812409813101,235:10.53812409813101)368:1.260808590104487)408:2.5934325060179937,51:14.392365194253491)530:0.15115194086949657)542:0.552359460556545,(((35:8.90089972096743,132:8.90089972096743)345:2.528433039475109,197:11.42933276044254)388:3.6373556107356464,(((23:11.25268626048893,175:11.25268626048893)382:2.048503036839186,((116:12.65511808323324,151:12.65511808323324)445:0.1416958400938757,77:12.796813923327116)455:0.5043753740010004)485:1.1627978497469265,159:14.463987147075043)536:0.6027012241031429)559:0.029188224501346838)561:0.32107507805210744)573:1.5389493743839733)605:0.9310734309789943)616:0.9579200995334212,(((((12:13.258083864703053,298:13.258083864703053)481:2.3870816681737814,260:15.645165532876835)583:0.3691476646541183,(38:14.03851491572619,87:14.03851491572619)512:1.9757982818047637)590:0.09433145022966372,(43:12.903464053576092,17:12.903464053576092)459:3.205180594184524)592:0.4698694801563228,(((211:12.944868913818722,294:12.944868913818722)464:2.346680544146915,(161:13.043665360438908,280:13.043665360438908)467:2.247884097526729)568:0.288166143609498,(125:11.601097168889149,134:11.601097168889149)395:3.9786184326859857)580:0.9987985263418047)598:2.2663804507110896)621:1.2980526997636517,((((((103:12.204591067386167,293:12.204591067386167)430:0.36936047913055603,304:12.573951546516723)442:3.292132970035114,(16:14.045864658123689,(120:13.283127332842302,163:13.283127332842302)484:0.7627373252813872)515:1.820219858428148)587:1.082763617090599,(153:11.952157890869122,112:11.952157890869122)418:4.9966902427733135)604:1.3635918366478528,(((146:15.128647653250196,((28:10.839039403152679,41:10.839039403152679)373:4.1928475323078125,(((69:7.814432064003075,308:7.814432064003075)333:4.899524581363744,276:12.71395664536682)451:0.12350655248891762,(309:11.415649415333494,(25:10.169183557363043,55:10.169183557363043)361:1.2464658579704508)385:1.4218137825222428)457:2.1944237376047546)557:0.09676071778970474)562:1.5192132841870016,((160:14.768745591108095,254:14.768745591108095)546:0.19924732547610802,(283:12.393139704597516,186:12.393139704597516)436:2.574853211986687)553:1.6798680208529948)599:0.016450473281377498,(((174:6.478564495139931,236:6.478564495139931)323:7.73759047579896,195:14.216154970938891)523:1.7497037792149683,(265:14.98465405940013,((117:12.095790848217268,67:12.095790848217268)424:0.23033842896647805,(215:9.68246547088525,180:9.68246547088525)356:2.6436638062984965)433:2.658524782216384)554:0.9812046907537297)588:0.6984526605647154)600:1.6481285595717132)618:0.8227141678744196,((((71:15.536999444298043,((149:11.9319074830887,(47:11.466882511822199,303:11.466882511822199)390:0.46502497126650155)416:1.4829779265672087,248:13.41488540965591)490:2.1221140346421343)578:0.30199701030119996,(233:12.71173539721373,202:12.71173539721373)449:3.127261057385514)585:0.36762630790806483,101:16.20662276250731)595:0.4603838091656911,((119:12.582314397353475,(219:10.435819114013421,(281:2.7992446854918605,142:2.7992446854918605)317:7.636574428521561)367:2.1464952833400535)443:1.7579283264187975,(81:11.938030067469818,(114:10.335783968834065,189:10.335783968834065)365:1.602246098635753)417:2.4022126563024546)527:2.326763847900727)601:2.4681475664917087)623:1.0077931402269726)626:0.4168038967998626,((((((95:12.770901412979088,((97:11.631204399143847,(285:9.266857340145737,(8:4.9322654174021885,138:4.9322654174021885)319:4.334591922743549)350:2.36434705899811)398:0.2848212577790701,223:11.916025656922917)415:0.8548757560561704)453:1.2815136514874457,127:14.052415064466533)519:0.4540658600357741,(307:14.048003119316483,(((14:10.354587616329622,268:10.354587616329622)366:1.0435541971385707,115:11.398141813468193)384:1.2902675605705216,3:12.688409374038715)446:1.3595937452777687)517:0.45847780518582404)538:0.7942235499119974,(234:10.961703573155422,204:10.961703573155422)376:4.339000901258883)570:1.9598932593628593,((((((158:11.8444889484396,178:11.8444889484396)413:1.069112713203447,242:12.913601661643048)460:2.361570164547164,(156:11.519504187697912,210:11.519504187697912)392:3.7556676384923)566:0.24053787407397031,(((272:13.46088080727236,((82:10.327741095830959,(66:9.018846254298271,70:9.018846254298271)347:1.3088948415326875)364:1.2779971382206412,316:11.6057382340516)396:1.8551425732207605)493:1.5894528338732634,(7:13.87266782254043,191:13.87266782254043)504:1.1776658186051936)558:0.2728245479975424,(257:14.94539636717542,(201:14.03005711679848,(99:12.713429332052849,((155:12.066538841849395,29:12.066538841849395)423:0.6239108340428157,(185:12.395555905616366,(108:6.420622637831713,213:6.420622637831713)322:5.974933267784653)437:0.29489377027584496)447:0.02297965616063813)450:1.3166277847456307)511:0.91533925037694)551:0.37776182196774677)572:0.19255151112101565)577:0.10540487858728476,((259:11.609296865332087,(121:11.056816378380221,284:11.056816378380221)378:0.5524804869518665)397:1.1463745207116194,209:12.755671386043707)452:2.86544319280776)581:0.3832096600830841,((((315:10.8053508710117,100:10.8053508710117)371:0.9906414014885847,109:11.795992272500285)406:2.2447264017154005,295:14.040718674215686)513:0.48863779573982846,(171:12.77443747555402,162:12.77443747555402)454:1.7549189944014945)541:1.4749677689790364)589:1.2562734948426133)612:0.10127921133212325,(((286:11.058398974807321,291:11.058398974807321)379:1.0018293256924515,84:12.060228300499773)422:2.7274097422427985,20:14.787638042742572)547:2.574238902366716)613:3.197874230082256)627:0.44877510596391446)630:0.12174871554736555,(((((((((167:5.6117196260872895,40:5.6117196260872895)321:0.9013103814459171,32:6.513030007533207)325:5.237932786764885,205:11.750962794298092)405:2.670965393019891,(9:11.750813650532923,270:11.750813650532923)404:2.67111453678506)532:0.20510562452940384,(188:13.280303503463768,(18:8.508191393755077,220:8.508191393755077)341:4.772112109708692)483:1.3467303083836182)543:0.3272417760553257,((143:12.942588923183244,(244:11.59744117888079,(73:7.14247677249892,(164:7.1272694784845,85:7.1272694784845)329:0.015207294014420114)330:4.454964406381869)394:1.345147744302455)463:1.7303644881340823,((39:9.387835951848283,110:9.387835951848283)351:2.4114333830969823,269:11.799269334945265)409:2.8736840763720615)545:0.2813221765853857)552:1.5798729185626694,(((238:12.857134153184608,184:12.857134153184608)458:2.3089643706642953,(44:11.80499583671634,(92:10.612468230770105,239:10.612468230770105)369:1.1925276059462355)410:3.361102687132563)563:0.27102038181573995,(((302:9.569544355312845,282:9.569544355312845)355:2.820663326949358,58:12.390207682262202)435:1.6599995942512376,(170:7.9840011823936266,(258:7.694341666056992,102:7.694341666056992)332:0.2896595163366342)336:6.0662060941198135)518:1.3869116291512036)574:1.097029600800738)597:0.9739450605423485,((((27:12.42818993150316,243:12.42818993150316)439:1.898212908653793,(((278:12.160272805721227,(313:10.905395212799261,98:10.905395212799261)374:1.2548775929219662)429:0.40530115449610093,104:12.565573960217328)441:0.5069761974839473,113:13.072550157701276)470:1.253852682455678)526:2.710553566010786,((312:8.925328685143441,42:8.925328685143441)346:7.180169625414997,((54:11.734729227224165,172:11.734729227224165)403:3.489292220156978,((148:12.365113150636576,(150:9.714087612898625,145:9.714087612898625)357:2.651025537737951)434:1.6461326625587773,214:14.011245813195353)510:1.212775634185789)564:0.881476863177296)591:0.931458095609301)606:0.06286826589081684,((141:13.950012241586752,(300:11.994367161566833,5:11.994367161566833)419:1.9556450800199183)507:0.10533411498646572,165:14.055346356573217)520:3.044478315485339)608:0.40826889494917395)614:0.38857885806297787,((182:14.45943530056502,((((((105:11.080286685470826,250:11.080286685470826)380:0.595566396922175,(266:8.436402477761032,80:8.436402477761032)340:3.239450604631969)401:1.3520782556913495,230:13.02793133808435)465:0.3342878287704636,46:13.362219166854814)488:0.48801700473283915,(89:7.181814987412334,133:7.181814987412334)331:6.668421184175319)503:0.5297549011118239,2:14.379991072699477)529:0.07944422786554206)535:0.6136027917543689,((226:10.111056486786712,126:10.111056486786712)360:2.112137586094301,187:12.223194072881013)432:2.8498440194383754)560:2.82363433275132)617:3.2336025716321153)631:0.8046687853534564,(((((((((301:13.203938860683763,287:13.203938860683763)477:2.652292723667454,(207:15.310515623967532,(261:13.42292185482785,246:13.42292185482785)491:1.8875937691396825)571:0.545715960383685)586:0.28913102705773497,(198:15.46310725875879,(45:13.199564797882921,135:13.199564797882921)474:2.2635424608758683)576:0.6822553526501629)593:0.90849065343102,(168:13.071459938417354,274:13.071459938417354)469:3.982393326422619)607:0.6545614690426689,((147:9.50141459349046,(299:6.963545944555431,96:6.963545944555431)328:2.5378686489350297)353:3.8632229751564005,(68:11.674134765568146,288:11.674134765568146)400:1.690502803078715)489:4.34377716523578)615:0.6837072435433207,(107:13.258304654180277,229:13.258304654180277)482:5.133817323245685)619:0.013204479926937296,(((79:14.045128174976089,169:14.045128174976089)514:0.15831351706777674,((106:8.580993684983685,251:8.580993684983685)342:4.459207289017424,305:13.04020097400111)466:1.163240718042756)522:2.9106398413038566,(140:8.35580397619033,33:8.35580397619033)339:8.758277557157392)609:1.291244924005177)620:0.703867384571879,((232:15.645136923700113,((311:6.877659514718161,200:6.877659514718161)327:7.534103239664072,(245:13.963126593764988,(128:13.304924983509874,(31:11.823859066704394,62:11.823859066704394)412:1.4810659168054805)486:0.658201610255114)509:0.44863616061724443)531:1.2333741693178801)582:1.2387069236707635,(((292:11.418216880593409,(154:7.894151942489412,63:7.894151942489412)334:3.5240649381039972)387:0.5994691320034953,86:12.017686012596904)420:1.2941595383647364,256:13.31184555096164)487:3.5719982964092356)603:2.225349994553902)622:0.11339144100128351,(176:17.145440996991653,(((255:12.111628613850293,(152:12.01990900769341,(48:11.85314272422407,218:11.85314272422407)414:0.1667662834693413)421:0.09171960615688235)425:2.3192435016259783,(179:10.198486803527537,306:10.198486803527537)362:4.232385311948734)533:1.1164994116509703,((((296:12.150807155262608,192:12.150807155262608)427:1.0870189245429813,208:13.23782607980559)480:0.49720932159081244,30:13.735035401396402)498:0.7645958436165845,(129:14.249770459160128,241:14.249770459160128)524:0.2498607858528583)537:1.0477402821142547)579:1.5980694698644111)610:2.077144285934409)625:2.712358499130218)632:0.0'/>

  <run spec="GPSimulator" nSims="1">

      <!-- simulate sequence -->
    <simulationObject id="seqAlign" spec="lineageTree.simulation.SimulatedTypeWriterAlignment"
		      outputFileName="../../results/validation_2_inserts/simulated_alignments/$(filebase).seed=$(seed).alignment.nexus"
		      numberOfTargets="1" nrOfInsertionsPerTarget="5"
		      tree="@simulatedTree" origin="@origin">
      
      <userDataType spec="beast.evolution.datatype.IntegerData"/>

      <siteModel spec="beast.evolution.sitemodel.SiteModel">

        <mutationRate idref="clockRate"/>

        <substModel id="TypeWriterSubstModel"
		    spec="lineageTree.substitutionmodel.TypewriterSubstitutionModelHomogeneous"
		    editfrequencies="@insertRates" >
          <frequencies id="freq"
		       spec="beast.evolution.substitutionmodel.Frequencies"
		       frequencies="1.0 0 0" estimate="false"/> 
  </substModel>
  </siteModel>
  <branchRateModel id="StrictClock.c:h3n2_2deme" spec="beast.evolution.branchratemodel.StrictClockModel" clock.rate="1.0"/>

    </simulationObject>


    <!-- <logger spec="Logger" logEvery="1" fileName="$(filebase).$(seed).traj"> -->
    <!--   <log id="trajectory" spec="bdmmprime.trajectories.simulation.SimulatedTrajectoryLogger"> -->
    <!--     <simulatedTree idref="simulatedTree"/> -->
    <!--   </log> -->
    <!-- </logger> -->
  </run>
</beast>
