<beast version="2.0"
       namespace="beast.core
                 :beast.core.util
                 :beast.core.parameter
                 :beast.evolution.alignment
                 :beast.evolution.likelihood
                 :beast.evolution.tree
                 :beast.evolution.tree.coalescent
                 :beast.evolution.sitemodel
                 :beast.evolution.substitutionmodel
                 :beast.evolution.operators
                 :beast.math.distributions
                 :feast.simulation
                 :bdmmprime.distribution
                 :bdmmprime.parameterization
                 :bdmmprime.mapping">


    <!-- insert rate and clock rate -->
    <parameter id="editProbs"
               spec="feast.fileio.RealParameterFromXSV"
               name="stateNode"
               fileName="/Users/azwaans/all_beasts/beast_typewriter/examples/multiple_bcodes/simulated_data/simParams.csv"
               sep="," startRow="1" rowCount="13"
               startCol="1" colCount="1" />

    <parameter id="clockRate"
               spec="RealParameter" value="$(clock)"/>

    <origin id="origin" spec="RealParameter" value="25"/> <!-- Length of simulation -->

<!--    <stateNode spec='beast.util.TreeParser' id='simulatedTree' IsLabelledNewick='true' adjustTipHeights='false'-->
<!--               newick='((((36:20.042957729681355,((6:16.6776275960524,93:16.6776275960524)161:0.7632803919191637,(79:14.277789050146263,3:14.277789050146263)126:3.163118937825301)172:2.6020497417097914)205:2.3859413225209387,((((26:17.490605182758287,81:17.490605182758287)174:0.8144298663614613,92:18.30503504911975)186:1.7695665858531626,(((((87:16.129923188392976,50:16.129923188392976)153:0.6494967202516868,22:16.779419908644662)164:1.3131379706592234,(42:14.742950916502425,13:14.742950916502425)136:3.3496069628014613)184:0.146577379582137,((102:16.630952696134095,31:16.630952696134095)159:1.0190480597998643,35:17.65000075593396)176:0.5891345029520636)185:0.6312613236201194,((39:18.043960727454433,((74:16.581586062065973,70:16.581586062065973)158:1.2466948978581591,(47:15.367646999141291,98:15.367646999141291)141:2.4606339607828414)180:0.21567976753030038)183:0.64207462834203,(((((5:11.026830062144692,72:11.026830062144692)111:2.1481265587594347,11:13.174956620904126)121:3.9502652435071255,((49:14.35265930333639,59:14.35265930333639)128:1.6756216876989054,(103:15.545066501295295,16:15.545066501295295)143:0.4832144897399999)151:1.0969408733759565)168:1.234652312292262,((9:15.328923976877256,(96:14.61160439049028,51:14.61160439049028)132:0.7173195863869761)139:0.11042294527655727,60:15.439346922153813)142:2.9205272545497003)188:0.20971180255063615,89:18.56958597925415)190:0.11644937654231313)191:0.18436122670967947)195:1.2042050524667687)206:1.0519990181126886,((((12:12.58783200690287,94:12.58783200690287)119:3.2097986813251254,(106:13.817466752629674,88:13.817466752629674)122:1.9801639355983216)146:1.8930661060678577,(2:12.887371270841406,(86:12.576025573888433,19:12.576025573888433)118:0.3113456969529729)120:4.803325523454447)177:1.1902957516495754,78:18.88099254594543)196:2.2456081071401712)209:1.3022983991166939)211:1.1505404804238957,(((37:14.624845605531362,34:14.624845605531362)133:5.307086494863366,((1:17.845352323843194,((82:11.536574499611447,28:11.536574499611447)114:5.820220460004116,64:17.356794959615563)171:0.4885573642276313)181:1.4565257338028879,((68:16.537319283803896,(17:16.411781098179837,95:16.411781098179837)156:0.12553818562405894)157:1.7738802486370062,77:18.311199532440902)187:0.9906785252051797)201:0.6300540427486467)203:0.07332960944147615,(84:19.117342786946363,(83:15.058622932421292,55:15.058622932421292)137:4.058719854525071)198:0.8879189228898419)204:3.5741778227899843)213:0.2240872191453427,(((100:19.268489960583945,((((25:16.72015503981605,((91:10.253079875025819,52:10.253079875025819)110:6.417166531503838,105:16.670246406529657)160:0.0499086332863925)162:2.122940154711138,(32:15.837918180762053,21:15.837918180762053)147:3.0051770137651346)194:0.23747226661609488,48:19.080567461143282)197:0.10426174491167828,((65:15.769316880429539,(8:14.546364414071585,40:14.546364414071585)130:1.2229524663579543)145:0.40801057901238025,(62:15.726955366626392,61:15.726955366626392)144:0.4503720928155275)154:3.007501746613041)199:0.08366075452898514)200:0.8914086275813276,(((63:16.256576925048492,(7:14.592804808513286,(0:11.7589722883418,(57:11.208535427763827,90:11.208535427763827)112:0.5504368605779728)115:2.8338325201714856)131:1.6637721165352062)155:1.4341440852527612,((69:9.250413508072477,101:9.250413508072477)108:7.96301887105243,99:17.213432379124907)170:0.47728863117634646)178:0.12622876678468486,104:17.816949777085938)179:2.342948811079335)207:2.2884249720948198,(((((46:14.381887824595522,(97:10.098957019622686,53:10.098957019622686)109:4.282930804972835)129:2.369613874086008,((85:14.044914083154337,80:14.044914083154337)125:1.9005509114062455,73:15.945464994560583)150:0.8060367041209471)163:0.2416202761984252,((10:11.405562314643234,66:11.405562314643234)113:4.45987266158386,(29:12.187848729739962,76:12.187848729739962)116:3.6775862464871327)149:1.1276869986528606)166:3.8501784330954045,((38:14.34253267582918,20:14.34253267582918)127:3.671845117392184,4:18.014377793221364)182:2.8289226147539956)208:0.4684875078365387,(((45:16.126249017007382,43:16.126249017007382)152:1.3156848868598203,107:17.441933903867202)173:2.229009003117806,((((15:14.67602868727493,(44:13.930124225135902,(30:12.398235335987277,71:12.398235335987277)117:1.5318888891486253)123:0.7459044621390287)135:2.490102891126069,((75:13.981536113272938,41:13.981536113272938)124:2.8377795331021147,58:16.819315646375053)165:0.3468159320259474)169:0.468905154832683,56:17.635036733233683)175:1.1819170755975605,((18:18.517467024885136,((27:15.856065508397974,14:15.856065508397974)148:1.2275826655665316,(24:15.066950851624842,54:15.066950851624842)138:2.016697322339663)167:1.4338188509206304)189:0.28984190889282146,(33:15.344866557346121,(67:14.653355452924371,23:14.653355452924371)134:0.6915111044217497)140:3.462442376431836)192:0.009644875053286484)193:0.8539890981537646)202:1.64084500882689)210:1.1365356444481947)212:1.355203191511439)214:0.0;'/>-->

    <stateNode spec='feast.fileio.TreeFromNewickFile' id='simulatedTree' fileName="simulate_tree.1234.newick"
               IsLabelledNewick="true" adjustTipHeights="false" />

    <run spec="GPSimulator" nSims="1">

        <!-- simulate sequence -->
        <simulationObject id="seqAlign" spec="lineageTree.simulation.SimulatedTypeWriterAlignment"
                          outputFileName="/Users/azwaans/all_beasts/beast_typewriter/examples/multiple_bcodes/simulated_data/small.clock$(clock).seed$(seed).alignment.nexus"
                          numberOfTargets="1" nrOfInsertionsPerTarget="5"
                          tree="@simulatedTree" origin="@origin">

            <userDataType spec="beast.evolution.datatype.IntegerData"/>

            <siteModel spec="beast.evolution.sitemodel.SiteModel" mutationRate="@clockRate">


                <substModel id="TypeWriterSubstModel"
                            spec="lineageTree.substitutionmodel.TypewriterSubstitutionModel"
                            editProbabilities="@editProbs" >
                    <frequencies id="freq"
                                 spec="beast.evolution.substitutionmodel.Frequencies"
                                 frequencies="1.0 0 0 0 0 0 0 0 0 0 0 0 0 0" estimate="false"/>
                </substModel>
            </siteModel>
            <branchRateModel id="StrictClock.c:h3n2_2deme" spec="beast.evolution.branchratemodel.StrictClockModel" clock.rate="1.0"/>

        </simulationObject>

    </run>
</beast>